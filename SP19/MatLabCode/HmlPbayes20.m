function [Y,Xf,Af] = HmlPbayes20(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 02-Aug-2018 19:34:53.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 20xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-6.86742363685032;-7.34803616881518;-6.98924863332485;-6.42101464692105;-5.81465486367505;-7.41032157778569;-8.19943012795609;-11.6382661446603;-6.76726291714004;-6.57670434053463];
x1_step1.gain = [0.109158922147308;0.0985030875484228;0.115309012499038;0.113086250098351;0.10122582467328;0.112108041062399;0.094627936498943;0.0796351273467729;0.122402009323546;0.113172797527467];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.1857238005217818344;1.0919697791730604841;1.0169787266563325989;0.80928332170352779151;-1.3969355009494632824;1.4021067784859606586;0.82565085517114078506;1.1592546498233025076;-0.92141381137117039923;-0.94109015694457676116;0.94645540915813164418;-0.90746800058617926865;-1.2602342077465373826;1.1866388154840392666;-1.1061240067012649835;1.1835357974832461103;-1.2202054952073850824;-0.93935153246816260886;2.0494703200517059294;-1.2018787633652168179];
IW1_1 = [0.010233322937184170104 0.037939023870822714823 -0.038210313940732057447 0.047268230607982616998 -0.0072319840510444025408 0.0095972816612441939899 -0.10170002947249161263 -0.03378937064559147524 1.3237030306705737104 0.8665133213706345261;-0.0036516327234705522713 0.055143077019757590074 -0.0029559652304028717629 0.0097080869038391609527 -0.037969707799988004771 0.054801154143236378846 0.086143529078449646019 0.11902758244974291635 -0.83726286052558374084 1.009806054623764604;0.022652180142969515625 0.045207735308339727642 0.059977360258573524099 -0.0322395582488252605 -0.015512157051987274237 0.063332980365623584018 0.11638598022669995047 0.15888631615199397262 0.95081349803593417924 -0.4481904507294112161;-0.00059232597329792802988 -1.1363603152707084818e-05 -0.0040983306306517043247 0.0061583831717635754976 0.0019941140377414123819 -0.006040456287194586292 -0.84242637597535829919 0.17903550102733975513 0.00068026044288976926077 0.0044552488494149682444;0.60293087891181140758 1.9598565783640049531 0.051028649710055995481 0.00053815222508248950536 -0.0094722475911468879961 0.074536889105921919074 0.04004737454713980932 0.049976200068577447677 0.064835298580896788545 -0.04177394192005110668;-2.2334619583153747513 -0.62225072411130533112 -0.08644910921905160639 0.044775105517113916731 -0.016255339897354833395 -0.041359866541133945284 -0.012297126741558186622 -0.010142172781959304245 -0.052353379373238348449 0.050658483611520921386;-0.00025404295690307067499 -0.018310779996640498546 -0.01839900969037320394 -0.0017883052083687632321 -0.53099565480364518955 0.58187545139960417107 0.065311123405448076595 -0.25366735153764402577 -0.012949125971508632787 0.0052959809296859233427;0.017166579599646007714 0.02020881904937405632 1.0903414773047479525 -0.2812559857608601388 0.0081023387042099565686 -0.00021322997216127896939 0.028322106626323916012 0.016449528588219120701 0.011037336910272954257 -0.010836014698518836238;-0.0041582101737993176771 0.0013224558747043449209 0.0046993034044229744367 -0.001006339050933430625 -0.01147985969514646494 0.010390412743094197198 -0.010407998718737305685 -0.90716621931178387239 -0.0013506898554934074208 -0.0045311901513539632608;-0.0020571778433347404601 -0.0030040663604729588888 0.0080765233688502025 -0.0031544767601003158297 -0.027467523421096103065 0.01937358172536087636 -0.38770732869926693986 0.98559419783358381828 -0.005302243876013643456 0.010968697738992195037;-0.010458093734209998257 0.010234294335055540287 -0.0089408491607823360747 0.017076436869997640294 0.788065459682125935 -0.6047808748877352425 0.10764146741658099649 -0.31529818070244958195 -0.0024341985829352229265 0.0025278131737139384813;0.0038958718986941902156 -0.0038375985539014050019 0.0091050570091285327329 0.0011681252011185015195 -0.021975388040859595434 0.01408273803801677812 -0.86088857771936300178 -0.14906164480688238738 0.0086190018297530954922 -0.0066541350778135102337;0.0079683013025121252754 -0.016358352700283802783 0.52384243539879682405 1.6354835852536599994 0.036772418893460022404 -0.016248949904900493457 -0.037470425923175752769 0.026070479189166634315 0.0043567062517532338314 -0.0031493370849974182749;0.016778653049906173955 0.0058906406086651329906 0.021636718823648440346 -0.001651237710765532862 -0.86748961910458732838 -1.2199881605027911302 -0.078613643736767060965 -0.017844175635436401728 -0.012696675855742280137 -0.036834274877513041579;-0.028033703410079522517 0.0060995859309668654796 -0.04551952864621645195 0.0059188365201117421055 1.3229928609413330598 0.48963317747084295073 0.063172905378132124254 -0.058406369007416060468 0.022001768190257873364 -0.00087124058368794716437;0.0011527228950345381423 0.0015861528977454367618 -0.93195528009158790095 0.50791507100300015143 0.029458531195530816837 -0.020512211678208189941 0.033496807829776931165 0.038668534845129977351 0.003720885945596541771 -0.0033231599993395321418;0.01144053300296470066 0.028171283627275642975 -0.0089245183633010292251 0.018347098631520203371 0.0068485888340373115082 0.023114368894086724515 -0.076198369765726789438 -0.0026599750728090315599 0.65609611862481265199 1.4198289180803147502;-0.0026416846840368428395 -0.0022908774023296420153 0.010041573182008859191 -0.0073484820720530292723 -0.0077169582451531385653 0.0096659093230607902314 0.42024417516039080933 0.6883495269728440169 0.0032425127250032279372 7.533372489744775948e-06;-2.5507928977077614086 1.5601973251480720783 0.079676065271203841411 -0.063847734089714530681 0.018936013216149138322 -0.029582907384354470426 0.015470534853979213061 0.011043390794092685855 -0.0095435788734501182662 0.047262068890843542124;0.012108323850039473535 -0.038130788917801194948 1.2019828534030532197 1.0185145815539389247 0.071389818905690169415 -0.051311656381879337807 0.0089356692070724358379 0.052200248376854420373 -0.012938467300035444776 -0.00028138624561612824489];

% Layer 2
b2 = [0.013828994667548130323;0.50418124722863777443;-0.14270229534818509864;0.070628081335181031042;-0.82589842783575417862;2.7119262123388439001;2.4145184451903545231;0.76944953026404694363;-0.91535953687973181658;2.1295644585216386702;1.1756017205470832288;2.0850923801974534655;0.75037448312575538711;4.7271492861281956266;2.8826680594767855048;3.8495241693209001355;-0.90014977497829151698;1.8961615794824342451;1.9860676443452689455;0.88182339009357102455];
LW2_1 = [-0.044719160161090940053 0.0067595910567743036981 0.0036390673174338974798 0.031553866324987300818 0.29306900410554570513 -0.85803534939235570622 0.0026088187977537820317 -0.1540995952495611554 -0.07735023252563585916 -0.050363995751285944857 -0.046597793119063590783 -0.054284450698106778699 -0.030291358882576380901 0.081183629985320776568 0.060200096056178174775 0.076504504824841224053 0.038604451906689402074 -0.11988338161832008677 0.72444405972880399069 0.050479972696256973641;-0.021779662127664318333 -0.036913516327741327516 -0.12660352173482361526 0.14719611180043798426 0.9877534364458463445 -0.21302579157388801256 0.069105571172104113264 -0.0453225452565086534 0.082052255730668793854 -0.04773121124537833132 0.14227299120634362417 -0.078962107893057631447 -0.01040448265416993659 0.025350170954704719789 -0.048121690942104701494 0.019656238777933748157 0.015794991583197724033 0.10055059645058267437 -0.41327559899032295654 -0.041273656288943944004;-0.035867017000610172672 -0.035802118768034831009 -0.11400555203966966644 0.12966384760735538695 -0.22527719139612939481 -0.88094843355996477197 0.051190544377243921148 -0.088229252909449232267 -0.025498504283128241299 -0.050475823031790184592 0.094134523603173592132 -0.093860905569070923748 -0.054937839767585115724 -0.010527806821659544886 -0.046094071747084096324 0.021536530174481222782 0.054158327784384119319 0.062713647517303253154 -0.26770437511184969059 0.053405867588891688114;0.0029481353802314025185 -0.014806284268362675249 -0.057356781923598325335 0.067978750144387617427 1.3166208499174825164 0.44265916624195050799 0.039294826443200196742 0.01642352413448022394 0.11546582315906363247 -0.015283782246166287971 0.090385439368897785295 -0.017318445861971915739 0.031183933448766649327 0.037357797709477731651 -0.019504106640215599505 0.0054851644150642180769 -0.024012810896713213116 0.067450822479561051148 -0.26798250090804576207 -0.089549109285600655972;0.026966969099100599611 0.0069006723317191339881 -0.019355712738223507241 -0.11398432479527732808 0.042599353253772329064 0.025546229528203456827 0.071956253092300706542 0.62268038277186832374 0.046737076965791726768 -0.0090116395199187314391 -0.12534678850898212099 0.1769459060662998684 -0.63395291076684201492 0.013436362098178963528 0.010434461513898637963 1.2646337483888383524 0.013787989789375558469 -0.043279577985444794841 -0.0027494074172237288091 1.4628085692376686655;0.00074584040053271528567 -0.015429534002091904732 0.011275095507682793977 -0.09637164098548010871 0.038281702085393547186 0.0010486246235184234783 0.031036353919651232802 -1.2448941079818229838 -0.073391446612267513538 -0.022858622741784549032 -0.0050084841458785112067 0.0068120014311883253164 1.0703976140162776431 0.029790289417368821107 0.012132095935353897492 -1.6695806662829293376 0.013250003678210411223 0.035349665469067211021 -0.0006566894280076320629 0.29337703410240717483;-0.002210450109392970465 -0.019321767235769535948 0.066182035583893364383 -0.014782881617764826593 0.01303901933276294979 -0.0059278654662325092409 0.075529569556514047912 -1.6362649096044272756 -0.040940394854364875465 0.0046547226815473003933 -0.043355744456965925049 -0.034410427732459218653 -0.96193210500689341202 0.092714852062486904916 0.086856708268921847815 -1.7547086547768862008 0.0080048262086248860719 -0.024422892231815471198 0.0046775045680029084597 1.802935534221070446;0.0027240180647535462005 -0.0021054543059507977755 -0.040330743412168953976 -0.10658219226503069799 0.036876330414235075628 0.0063515684447722729755 -0.02252926862692540208 -0.18220622553430099178 -0.061560204406858338999 -0.034050585844199447727 0.031620674202551796173 0.035569022507017225565 2.1591784590644222952 -0.040054389014499806876 -0.05816553714352454274 -0.61601668636400630508 0.0092839065426822530575 0.062643008686145723596 -0.0044480038538455843669 -1.1538368153798617133;-0.01971969001017810641 -0.01785967844484670497 0.021525573898984955157 0.027818372079126216928 0.0057642200923382199904 -0.035787734545365115779 1.3204283652313093533 0.041137149815488507909 -0.29191255342836885944 0.47766908974888971917 0.82250444203942985055 0.080273523691067327768 0.0060416881142684635345 -0.46133840974493706133 0.23583112913774628705 -0.04076073014710845932 -0.0047428028505366358683 -0.012213416756603220556 0.015773256826071328784 0.014349072934169961047;-0.009476109862871060982 0.0096510481667367638975 -0.0087634804324964229311 -0.17125800371107108289 -0.00047359385031099383422 -0.010410134243382104108 -1.6661274280490629973 0.025771931988741593467 0.32806184883981426292 -0.3052657615092019272 -1.0551450316230908122 0.058868406599548311897 0.010835359497742128032 -0.73474321586567403752 0.64261997155657868408 0.018830832194329294449 -0.012439007795821722946 -0.2508987776870160169 0.0022599552121940315666 -0.0049103799735205309884;0.0045540401004483116454 0.0085472014945925413321 -0.02215941532506075437 -0.098777307559553509386 -0.0076284116913487619652 -0.0054490795328692599037 -0.705275879643403103 0.027518082008084164547 0.094041629186343303481 -0.1424281578699980455 -0.68718593664815086353 0.038449439698468215743 0.0092456702069826056378 0.88144326382184079449 2.2091103363025346162 -0.0075349513056994013582 0.0075469080762888881425 -0.11194044207954606529 -0.0044934265555122030952 -0.00046081895732448622258;-0.029937092768812550297 0.0080444253830819299061 0.023315570551576344366 -0.20164237379143853945 0.012034213891194016355 -0.01344564868034979141 -2.4605538544107496968 0.010594284354682580868 0.56072702285391562427 -0.43012208104811583409 -1.1308072898309977639 0.058900925974238273197 0.0054836213282850173809 -3.2135387327069624419 -2.5033304166735179663 0.059303910475008332626 -0.042227998742818108335 -0.36547806186186293509 0.013660513403491959458 -0.0090987707793163535852;-0.0052030419455334339304 0.017980265409511284741 -0.012467188095834507572 1.210063575641071143 0.0010318953464392270365 -0.00073697684208498331297 0.0072119342232088755676 -0.018381884977756200034 0.14927628824767641413 -1.7184386725653741923 -0.0031808884800162751973 0.7293024208967595623 0.0062332181844663098538 0.0063849660342084205503 -0.0077700077843534682415 0.010885676188961888183 -0.0012981118448915883457 3.3380046393431039853 -0.00030551247813534059038 -0.0074811052631344266209;0.00036940717822198896074 0.0047183112660900044036 -0.0065626004950410697994 -1.5918647228778846081 0.00055274550801378728119 -0.0060203034625170544561 -0.10205579302343753545 -0.033522309654714886606 1.8427186295301900554 1.2605187367209449434 0.047755915098633146265 1.2132114630987067549 0.015678613786472610225 -0.010765242182326099918 -0.0019867669601329679754 0.029974806615510756619 0.006913898761174500085 1.9412823841841180261 6.2783014561624108166e-05 -0.011018288543182855679;-0.0048848983784961540547 0.015846246539197993142 -0.021912487363061301099 -3.1157411564888524147 0.00070704792781533132729 0.0036870100953018702418 -0.067204147974018066392 -0.016493640868731729299 -0.64067194372764713073 -0.0044324473668950082478 0.016728581138944573908 2.346766026843908115 0.013318607443457647008 -0.012607188064664577587 -0.0051341972370219394681 0.025455522177177385135 0.014510054181553931271 0.65089270691203360286 0.0022724565603160920904 -0.010383347616116598081;0.00479041112801529851 -0.0063137606823050933594 0.012363484584105110739 0.52481894352815205984 -0.00014607383518645006434 -0.012179806291237136456 -0.086135929151305856699 -0.033128948343630011675 3.3024660778640528846 1.8626806938012869796 0.056367430063550667818 -0.37617400793545402449 0.0092752553910075800914 -0.003376523903905196116 0.0017249248599412307127 0.023002413522923776529 -0.0038901051182420732892 2.2594711362234276564 -0.0017185911090400111771 -0.005849056368801200563;0.57472803774233460761 0.71272449065497056608 0.75456172660973785948 -0.11366352160284615147 -0.0223317898813335039 0.041255981047751077995 -0.096970616925872638037 0.059511645468953155991 0.11883783324537884607 0.076802055912740668786 0.0090460439116364314144 0.074183675180595043397 -0.002582387763126218691 0.017922530782661812848 -0.03781408871977714331 0.025258814604546219601 0.00073631881438291778459 -0.053088840469381455567 -0.020484517011399871328 -0.034430006787024763915;0.44473231961899672982 -0.92379545206651891842 -1.1727624897526809367 -0.15595380616528758955 0.026282088206808173342 0.0045419990040908341314 0.029638504460194434187 0.086712392631636839302 -0.086029290314197301437 0.069544794808556603671 -0.052294576610555296159 -0.16251461718424736747 -0.025434219672648521182 -0.034541804158698639904 -0.015373742538517452122 -0.021361503789167301387 0.90187237036833312054 0.12129831391622820924 0.0029104306582433230044 0.021548029746326764072;2.4740396578816015172 -0.8354116953755360564 -1.6641784121843237187 -0.29231527355310871208 0.046438440534971599238 0.01052943540121783865 0.01539162974663606763 0.1208719684883748785 -0.17408076256039739516 0.1435997834840149201 -0.042417516373141277153 -0.1210758619081551829 -0.025350221775306856081 -0.13082953599056382221 -0.0651865079068006531 -0.091550477980500880038 -1.5125395668124912429 0.12138782582494929418 -0.013440498086967348629 0.0054850516167442783799;-1.2086780598061865888 -0.69424676378019378742 -0.43001785150408711189 -0.00062572259812617618893 0.0024643833136937859027 -0.0013552451997214005897 0.034293238061924413707 0.035348869126103556193 0.00050837575941405045363 -0.010617556652452193183 -0.041148818093289345199 -0.14468927813402740479 -0.019368616239246794208 0.04978813061102415477 0.027058794061486233368 0.040530786044109881616 2.4130093357197712756 0.079268278332519911955 0.014555385700774737395 0.027998007849770894379];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.0188117963226564;0.0103195590851694;0.0152433032264625;0.011915029151752;0.0167498240778173;0.0125203638148894;0.0186505694634926;0.0157615369458884;0.0115761231484842;0.00821103495218566;0.0102874622189846;0.0183862770989852;0.00950637708368752;0.00746116948320064;0.0119517615856925;0.0110126037227308;0.017024234406207;0.0113844845954145;0.0218269945750798;0.0162459507455786];
y1_step1.xoffset = [-40.2639117995613;0.0406314994409192;0.000111450359302022;5.59364054654817e-06;-40.9099698880564;0.0375603899322074;3.10599224499654e-07;6.61906653990514e-05;-64.4694519771506;0.00670902388685832;2.6972517211661e-07;2.63718422563581e-05;-77.1108639352254;0.027887382859933;0.000162164860334779;1.14981057367649e-06;-33.9119082180647;0.0374604304406662;1.52250802892828e-06;1.00751240321817e-05];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
