function [Y,Xf,Af] = HMLbayes20(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 02-Aug-2018 19:00:13.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 40xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 20xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-6.86742363685032;-7.34803616881518;-6.98924863332485;-6.42101464692105;-5.81465486367505;-7.41032157778569;-8.19943012795609;-11.6382661446603;-6.76726291714004;-6.57670434053463;-5.33641821872806;-5.7479161306225;-5.67985501172436;-6.12954386102445;-7.64316706160457;-5.90653966833506;-6.42539465394131;-6.03489062812296;-5.06476443929631;-5.83197858411584;-6.82670996645428;-6.57050344774642;-7.12781992409911;-6.23710936048471;-7.87032678313961;-7.65940588132709;-7.33632059674665;-6.80809937469424;-5.6055450819852;-6.48096780142358;-7.58873318762919;-8.09430179265719;-7.56915815880282;-6.12220137964717;-7.0770312083796;-6.66908567709054;-6.11269529457774;-6.76973919131914;-7.15698049946618;-5.20543617900013];
x1_step1.gain = [0.109158922147308;0.0985030875484228;0.115309012499038;0.113086250098351;0.10122582467328;0.112108041062399;0.094627936498943;0.0796351273467729;0.122402009323546;0.113172797527467;0.120421114587058;0.1227447633232;0.114890942911207;0.102645186757907;0.11279341040116;0.111633883613838;0.105445364697799;0.114627708449676;0.113174306276469;0.109303379463662;0.113607516807783;0.1000889992582;0.099518635752266;0.100569256241113;0.0994883684934118;0.104605181944146;0.103452597116236;0.119619250106823;0.116548011075068;0.107529760869952;0.110739933756507;0.090147014029851;0.102057811013221;0.121560330905869;0.0997849916275773;0.110419469397629;0.1179333949776;0.105001154531533;0.110635831686148;0.129095735887209];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.2100636454043331991;1.0624558421702845479;-0.79257711403874098188;0.89625502429992043307;1.3445411866819336755;-1.2304104526350423399;1.4264932948609831964;1.0484860289665245414;-0.95591005367839920748;-1.2308009680272962161;-1.3436187712085922996;-0.89686344133531459288;1.2256346358450542766;0.88061084101598319229;1.1273486431518713324;-1.2120298825840989387;-1.3047512763552602255;-1.2868447536971230338;-0.93765672565495117308;0.96190771905542804543];
IW1_1 = [0.0028598695810217347572 0.032737811833832355934 0.021649502876353962644 -0.01357199631647171105 -0.86611595001480745637 -1.2775167703458114588 -0.056964771869122646231 0.016421849870276672423 -0.012725549154508417407 -0.023657793211625879892 0.0050583635147213564312 0.015622614785743510132 0.0073210525452824821296 -0.011839324536967068061 0.013670094865955885813 0.011012986929450642101 -0.0008884884954999547552 0.012736077622245153135 0.0036865507256309947709 -0.02341263314396814163 0.00058275532112699111442 -0.010130743375753925584 -0.0092822210429160251222 -0.017013343330288362848 0.0095783374112810935191 0.006208870292654479657 -0.0038271708566385595311 0.0090699705452518524645 0.014133516076568762229 0.011132126985336868522 0.0091659799984156135194 0.0026714236693004297755 -0.0052846154802418509461 -0.0087320844567745567466 0.016745867607104069491 0.0032577061357720580627 0.0074051184618183852129 0.0056066346981331147831 0.025271905543201703126 0.019198618455241747704;-0.88115293190709143012 -1.1922967792229774986 -0.064423845373131408132 0.029732620816772165062 0.0039330584226316221003 -0.014333188145306348729 -0.0064764259529462662318 -0.033669947970120385483 -0.020516637089501278679 -0.0043250216921537918205 -0.0086990759874750606118 -0.010537759707475316887 -0.00016510969867100585033 -0.0036795685610684527971 -0.0082152716748941853608 -0.00049618337020795216016 -0.0057145767185157042567 -0.0045972916666366181807 0.0050553536172968085646 -0.0055045731960820789772 -0.0056118585740265215789 0.013968634370816260248 -0.004478043007583605746 -0.0019250930277464424131 -0.010393009145605638585 0.0054421104898734048647 -0.012012858607097106484 -0.0034331378793898852976 0.00045145657478122086471 -0.001095778547730112077 -0.0078412431657071401947 -0.0080834810653824390458 0.00086982327908290818768 -0.0062543157857640136257 0.0095071257147402721266 0.0033666555300757403275 0.0068343819144974522067 -0.00067358588033211675653 0.0098486854098425967441 -0.0067036316752192058946;-0.011760953392614908672 0.0095670174561873228686 -0.014968607415558950191 0.0046593969564871226888 -0.012578673220105918151 0.012279190600070698583 0.92964558553112974781 -0.34328280624473545002 -0.0043639640404683974206 -0.0085459773595503978755 0.0018496701879940303723 -0.0062865069154384332559 0.0020914086907396190439 0.0036532892464233080766 -0.0020612855493214532823 0.0057451388893254773035 -0.0011268118284972290701 -0.00037346392369530875691 0.0033693382521692333449 -0.0057557235066469716878 0.0039067933133525882192 -0.0011784623794728501904 0.0077141516037040371023 -0.0014761002807423834887 -0.0032551271625959506129 -0.0032508764552473131369 -0.00020823569711517531957 0.0032099665169961289282 -0.00043596149580680057262 0.0035358019797651608039 -0.0015383069363949046764 -0.0041590945868306755315 2.7505504698386068523e-05 0.0097791875302076641807 0.0020485658828641247105 0.00078051704467410284484 -0.00030510196113864269203 0.0016413756247307055743 -0.0031827260644200659409 0.0075483057785697225267;-0.010491947105224212755 0.0021328384512223335506 -0.0010090255580795870829 -0.012040501560646172177 0.034932361169040207494 -0.028619324968784141255 0.97344357447461726807 0.1757976164514273576 0.0077382163495995507155 -0.016439998756987136974 -0.00088808606182718145741 -0.012027391473457505963 0.00039686292846518195785 -0.001149898383243383752 -0.0015102078056877354505 0.0031821300452963469964 0.0015139258320168429584 -0.0013473939491041805622 0.002855891982469586747 0.00020715946315954167074 0.0036373849878781742452 0.0017672956433711424929 0.0066922918567751399355 0.0063010836431048600215 -0.010580326492591904039 -0.0043002966640854874483 -0.0072934056663129234396 -0.0087948087574601114397 0.0032419953921172090482 0.00045493002390502724607 0.0028177040647572779673 0.0073489764419852479996 0.0036519206496250125431 0.010417055179928457267 0.0016742841153817456662 0.0041422265556795567765 0.0001099222871585830405 -0.0065153356052399845691 -0.010398521186807117497 0.011226292514453136903;-0.042633678091167991064 -0.054663569065604079855 0.011522635953745738457 -0.032604005095632666855 -0.024691078604044396083 -0.047408337890245004498 0.10475770183719962381 -0.028329208657344954331 -0.53363691400095414341 -1.7992974271313360024 0.0092668600549304282893 -0.024791211721519889472 0.00046647373387454399733 -0.0031272892835378404523 -0.014192327705215149539 0.010704037717478439087 0.015027249337748516123 0.013852618167202880584 0.00065019390638419672854 -0.0088558150228309623353 -0.0092719049158078437056 -0.026928653753069957399 -0.02457592232679372754 -0.031771796251017260515 -0.0032851317381502138579 0.0035871249353353492316 -0.011731635553054514318 0.0022455928865635645629 0.0031836360014428524527 0.00075947082888311160699 0.013195849825537998151 -0.0016572275626579894767 -0.017083181511580728534 0.0068595112125071763462 -0.0035492621260874088196 -0.017787453218654464271 -0.0091755308081661116071 -0.03930481586315190401 -0.00041029154431395476821 -0.0074105110174909312806;0.018469138974351956284 0.016226870258102571443 -0.030253304721920851184 0.032610763061943985608 0.028421477894304505996 0.038630404849506444487 -0.097919018549540021157 0.0015096806445170274282 0.98711886598306464169 0.95517576940952497733 -0.005740601171539828039 0.0061711220309286296884 -0.0022534676415967521725 -0.0041517922577837471088 -0.0056082714592496449996 -0.014652679031328672346 0.00069954375475885486897 -0.012452795588751940439 0.025082523462405099252 0.0033518683412726143697 0.0087161925255197433837 0.01171386069343295297 0.0056165463722885672002 0.018597395605035434152 -0.0071206862008250894 -0.0024380991653901681361 0.0098020930979451151299 -0.0046757345705897923951 -0.010980490725521083184 -0.010765425215004103404 -0.0035741990786425548339 0.0048054837867385867545 -0.0020793978460640987448 -0.0020078447459545636922 -0.0064788112047117468045 0.0018723704451848216697 -0.0010600114969669912398 0.0036704014717319076617 0.0022458943439620047272 0.0066484412020002452495;-0.01205009577249964263 -0.016215027170907860693 0.06789904493789063189 -0.014816663518039957168 -0.031558963550912734475 -0.033315585551917999141 0.1252805176653187802 -0.0424870901859559294 -1.8354058452452077788 -0.43027755379413956671 0.0044977933274493115193 -0.031126223916580993134 -0.0077311014157569728916 0.019329185217508402378 0.026470847726592618143 0.050332017831974815159 -0.021536413805575700675 0.029314802335183239718 -0.065027199951255984511 0.0081101576459744820213 -0.021480710680422288039 -0.0096482195759252306622 0.021314918578405023936 -0.014697816031980125845 0.029893697309422810615 -0.012493839427587642016 -0.0042337290845599374889 0.00066476273863884534875 0.02753516811822719762 0.015005772602701536803 0.0056674650821214138385 -0.0085451274898872085078 0.02474406465497080293 0.0033723264806151793081 0.043817451725197985313 -0.0044382498798424072778 0.023036666114255779231 0.023937386157423190536 0.00041492155439117116116 -0.0080189126562890469807;-1.2395342279649572692 -0.29837547504436895407 -0.056326698901549267229 0.026465667409056394671 0.011117407993629847829 -0.0038532070486775862536 0.008953692232708776802 -0.0038648658108731467203 -0.0029688113358650272157 -0.00140283589103844036 4.8563880961623355297e-05 2.8605268710089443876e-06 0.0047035417336716784167 -0.0025967537682991242293 0.002525140719062686067 0.0078492167379662497462 -0.0060957013452196673331 0.0095016701164371050042 -0.0066900291090639584998 -0.0054773890913341113235 -0.006067147185106347082 -0.0059656106313688136641 -0.00024787042482793842247 -0.0058110619338346079094 -0.0030398489947311198994 0.0003918175920450845404 -0.0080544424389358808963 -0.0069928722137387912261 0.00064925226354870435499 -0.0042369557564280770079 0.00075630106156554315847 0.0084492235559911633286 0.0055720299239337420585 0.0054520049206795880015 0.0034997963402451865225 0.0046961461844761877987 -0.0030594675298532994327 0.0011829627726746509003 -0.0080493719860596658205 0.0070941520071931855537;0.02674239974812600909 -0.029879516603259975022 0.021094086470036021996 -0.026500446483350009741 -0.88498597623402597279 0.75904705704549335632 -0.29180035566281492532 0.29556390285133782303 -0.015752210529753486734 -0.013506339169824211136 0.0056958168178176636631 -0.015100095326350525607 0.0071376365578340057044 -0.023527374153408817103 0.023788524264372851863 0.0072580794134788290464 -0.0075340018774679900007 0.011610010168587578394 0.0096131847160474941799 -0.025991522970488598748 -0.015966241460302187799 -0.011152353069712454825 -0.015037976146692914534 -0.023077412511020606312 0.0005880636210349970798 -0.0022147923124627767223 -0.0089465925613102185304 0.018380164149851888761 0.0011663393611180514382 0.013640404532441799054 0.010347869141105645388 -0.010808516525467019506 -0.015074395094075503446 -0.0023997274241346973518 -0.01094444751383957283 -0.0062686455898727571831 -0.0052778818071176018117 -0.0046599851921062902457 0.003122212369329488077 0.0074470718128576323183;-0.013520822793145020196 -0.048212300995085034805 1.2764365806929591773 0.9879263682186146811 0.067404271587449618441 -0.044944823816506385139 0.010163628403309591525 0.084203426148256391159 -0.0022852790494509956851 -0.006521714218553617548 0.0071347817248496054471 -0.015344806554474191285 0.016354588866150276266 -0.006510988934262343375 0.013422642852390226365 -0.0035119749233746932852 0.0014802455101424920932 -0.0035476386214429939461 -0.0027661792591643116594 0.0046519022148332044714 -0.0030622877885604035154 -0.0060625186397279965181 0.0058251690338357794974 0.0073551189526861538229 -0.00010397097586504221221 -0.0068240258757924160751 0.0089957791530341710273 -0.0043680601298884142586 0.0061814111579206994576 0.0067577473964600138362 -0.0035508819355430528385 0.0046704612013681997759 0.0088469229856023515884 -0.0053418192104308674303 -0.0012454953955118469068 0.0012930192993327027911 0.0030389505177786700976 -0.011558330932095529572 -0.012440668437721146 0.00033395211735013513327;-1.4829709854485282339 0.029651029365127749837 0.16235125193038393854 -0.056150609998190222083 0.013723920273257608077 -0.037872207402823682143 -0.034943519508955890596 -0.018582710733271994019 -0.014508994232848316033 0.03066787491147142039 0.023935020173278590688 -0.022248855682726470517 -0.0053638450345275335077 -0.012671446960467290174 0.012839324893799609895 0.03882251481605651644 -0.040373005441451545461 0.023826485619526389936 0.0078872797222872444156 -0.05207665077577914442 0.03500953789496135532 -0.042688808114038349906 0.056349670962908479654 -0.0042347871864470013406 0.0038352390553132971809 -0.0096495063378309840763 -0.047446298713932688607 -0.047623946349127345423 -0.021176070255872044001 -0.018867913261844202616 -0.019884666069984468367 0.047236761502144654357 0.014858327407103707682 0.08076751923298394753 -0.0087975056330663065768 0.040711510588869181948 -0.0321911200144995302 0.047907939897786938621 -0.061179179433823525913 0.04840144820894214106;0.01200154623708531848 0.00096524254184357418523 0.0025522629457926321664 -0.00069816810879529133966 -0.023038067163282875682 0.022650755924974959321 -0.035235476262601476971 -0.99966859429649013169 0.0037735545872518158964 -0.0082605400123570947579 0.0013118695628446994626 -0.00041893562374425275365 0.00085018305078128143023 0.0041793394921772666212 -0.0022693772284825266747 0.0067107806685544873354 -0.0066204802251649706377 0.0045251371978714764049 0.0022464059694622057553 -0.0046515173138595503066 0.00088841632332080529549 0.0023094971929332594116 0.0053585224912871707789 -0.0043530227966734127976 0.00026062272501281916193 0.0017626469366200476704 0.00069189098268481288075 0.0060266422292194260155 -0.0022366194795382494075 0.0031083934194818456202 -0.0056126838290868515113 -0.0026740827903487954589 -0.0010652054679595171147 0.0020738774030142625993 0.006676617465085695792 0.0027345389958565178082 0.0039063935950343752629 0.0047467910155399332603 0.0078195850416104793756 -0.005123493954540968634;0.070243158282162723727 -0.0072584469457638405021 -1.0146331586824883786 0.58266846264925631349 0.061923352719116128706 -0.066643073433092975266 0.050925665960462086768 0.013077877687036434592 -0.0053750691539506461822 -0.00081829990373615425076 0.0066977733134872133661 -0.0027349664858857627471 0.012003313898814104571 -0.0048251295189979679159 0.016956851597102879509 0.011333230725695593588 0.0077541607195679915221 0.001640864369873622523 -0.0070255567949293711016 0.008378909812130332091 -0.006846247646121107755 -0.0086967419647533770327 0.0117372810672532156 0.0066125861773433606411 -0.0019218316819868597103 0.001963896694296143712 -0.0025507461384223712245 -0.0036101443678061015743 -0.0026041501461062941183 0.0011158612681890027994 -0.01308263622962263506 0.00086021896319697882353 0.031374122606653363776 -0.017960819382040013603 0.022373782262929475112 0.01275203900568400682 0.016745893754795172087 -0.0060080370882486123368 0.0044688196323365162246 0.006044555114821112754;-0.037321957561181555441 -0.0099738624331209089352 -0.026810391976177700563 -0.022073360495448647589 -0.58007741680148172669 0.69622939167575770281 0.15137683900667184278 -0.22594268523765811962 -0.0093506720359445138352 -0.0039373043400033249511 -0.0074226660067763005138 -0.0083299699451711874121 -0.0022703214903666531568 0.0042758314187890927166 0.0063954185560975507566 0.010523140804856483815 -0.003775382286383862241 0.0070382319120332369547 -0.0086161442964544174977 -0.010581148142353086206 -0.013768362177921907377 0.0041780851070274552597 0.011494704535910954188 -0.0076094380798936486071 -0.0030696084455215967568 -0.0033982530625473444247 -0.0032736040281091138317 0.0078938870199396805882 0.012864997685056450347 0.0047187087435487939935 0.014014215581483666778 -0.0036702505782385446212 -0.0061707977698721664522 0.0066495593884517327846 -0.0046021519014951542056 0.00024342035927109485901 -0.0048900415279261016249 -0.00059864141988596661619 0.0029165247643572395943 0.0043213256638856157449;0.035583197125374367575 0.021840223166405957345 0.056196722931628848019 -3.1048026477264877466e-05 -1.3624932922720658368 -0.48625693227930011364 -0.07171324042451075742 0.10107700127426211267 -0.021241057793585670088 0.013873112422448846681 0.0062029663141931071571 0.016666343714644614449 0.0098507615774802992359 -0.008568493383659774032 -0.018190166762264037281 0.0077444619639231403185 -0.00051978336323822954112 0.0074135760837345590635 0.0037847160864030223587 -0.0047824930925325142769 -0.0021490172094892996332 -0.0016253496711530685589 -0.013953680347317419172 -0.014447736683288549958 0.00095642181520841059242 -0.0035621940954508671262 -0.0040152140966903514946 0.020719533306408154105 -0.00088316368526681579987 0.0030478382808381949097 -0.0023189015586445463693 -0.011342764342193270219 -0.0035714643579715095283 -0.0072278844418422671589 0.0058465693379498012011 -0.0024279784071943380508 -0.0079038623425199093508 0.011353005162747812837 0.010694276174597588946 0.015952950111761007163;-0.10273581251363785027 -0.023788394606074809295 -1.2704707872796490165 0.35351392716929119775 -0.042362457179767436244 0.026686950160616781241 -0.033421407480490460118 0.036890297866947932559 0.00039350081752191965042 0.0021265472784820758402 -0.011868092143643996228 0.018475392635437994093 -0.0014017511722542808431 0.019166966422709423579 -0.0074474693664099119242 0.018355131364201512922 0.014056227226125853416 0.0014983569444041175758 0.010207718645151256376 -0.0015128334462383452065 -0.0099571718539033047396 -0.0077029282303776331481 0.0028900904529636523704 0.0088417562119436094586 -0.0043354383668931847223 -0.005299418020250585247 -0.017421184294003234233 -0.0045099307792194134881 0.0045736837661589507809 -0.026027908604928321618 0.0016409103491955481097 -0.015047222834242802297 0.016709315152766260337 -0.013198838198570509925 0.040309782462134367831 -0.00065278774375613951748 0.0063015126671147544957 -0.0013958371979944891091 -0.006212554601827039065 -0.0064367915775718730076;1.4141098108392018418 -0.74131119530815248186 0.024100039488982569896 0.015811808574851104331 -0.0011720997029824222879 0.0045308745600247963409 -0.037761094245760108701 0.0049014350732199361838 -0.014794253131939612278 -0.013348086396314485028 -0.0084151635430520493192 -0.017655873122627948474 -0.0093139507002161312649 -0.0018025901586209600817 -0.017719937709484157029 -0.010016727484086407687 -0.01143695164612532067 -0.028906930181987783302 -0.0022832637751433785232 -0.0048062309724083420934 0.002334302235063907046 0.017525168155619438165 0.0023686479628339620652 -0.0037895321657548989257 -0.027074955055556425287 -0.011611069380342673926 -0.0074982094495994276034 0.0096805600744990921713 -0.012840135312863983769 -0.0043782077698329953733 0.0085698899467490131932 -0.038100200241681939084 0.0077973272801976547391 -0.027413144777579886296 0.012146970590266936013 -0.015724750028020494791 0.0094329377793399976637 -0.021079435397334287533 0.010735581374954891037 -0.015283653362177195695;-0.017854149359022016691 -0.00018924075924032026947 0.4819846937519154384 1.7124185167993442036 0.036838908825051308593 -0.015167743072586207034 -0.043199820724139734174 0.067953728234111845929 -0.0013954140071590081813 0.0077113728659937187671 -0.0029158499488459535022 -0.0083636689888779147672 -0.0055257069143286501392 -0.0044901042347672611571 0.0050185377224801867857 -0.0078655050586512037514 0.0060680412812848900581 -0.02406590940740818349 0.0065317723279814153894 -0.012189925920020876215 -0.0034241513212789121724 -0.007799116880423366191 -0.0076576906597663162157 0.00013743710759533232118 -0.0049959153576567974855 -0.0060177683971464630136 0.0082614741339798354602 0.00067947567692716072385 0.0041603545576125288558 -0.0031263487257477112075 -0.0045240010850359849148 -0.013037416397940411114 0.00037641120952479475634 -0.0079510548576445377877 -0.0066050206295299191545 0.0039094616070983485151 -0.0074535651242217159165 -0.0084672897791524103644 -0.0028212454577169116844 0.0079538603268024705983;-0.002112361772579692161 -0.00033440258130461905216 0.0043036440365759138713 -0.003082779174212009303 -0.036409965041440665867 0.044667897979360098037 -0.32798602468373583285 1.04999267729901824 0.0020857746369996070165 0.011249227433125629644 -0.0026688015015813139688 0.0015259158222088249797 -0.00039010776266668734233 -0.0063710442956394497394 0.0028866374201824336089 -0.0040047790263355847323 0.0033321678615935612817 -0.001199844167043571724 -0.00029801071063207187906 -0.00053022819019399899769 -0.0029642478606566827898 -0.0013451624849158106377 -0.0079106663784709301684 0.00056960584714250126794 -5.0043444260007086469e-05 -0.0013206431882312656776 -0.0014438630353023052238 -0.00046563892755500674997 0.0010440469500269799075 0.00083568247766321965969 0.0045264229583973332807 0.0035040296103718707524 -0.00018917269080778070008 -0.0035747643667326388546 -0.0058463130086064372948 -0.0025060423467580905492 -0.0029636356326511797618 -0.0059292591823667242443 0.00095965287700826187693 0.0021809163129949938296;0.0062542896395700042778 -0.0056448794239622769597 -0.0050008858922106214084 0.0033634300571166314553 0.007644422122163118706 -0.0089307034644760217856 -0.58474585850703131307 -0.66477790102896983093 0.0020676646194675400714 0.0021244070761902433819 -0.00068346620862301922864 0.0020823027650840111868 0.00037238656382494842194 0.00086319802319777120311 0.00034220347451419753709 0.0010167724392644089063 -0.00055302607582491771551 0.0023531530367441344 -0.00089188906724053950998 -0.00095483301367385023037 0.00022297213256042432671 -0.0027185089308530687932 -0.00031646269406051581339 -0.0027688311329158517456 0.0031505664890116732123 0.00071801925980336184577 0.0022953755332258255796 0.0021928017494367351911 -0.0013362086627737713822 0.0017943544000587779465 -0.0029331826268534197562 0.00097000325990684093877 -0.0013533406969770769325 -0.0032773423151615213751 0.0027509955623244318132 -0.00068766047620288949828 0.0024480104257048039031 0.0012122286746647820306 0.004717647094992819326 -0.0056065292613815429987];

% Layer 2
b2 = [-0.40001207551457490519;1.5393646301699253076;1.3354977721408116675;0.10225571185665816021;-0.61554784091300485116;2.0979846260292469573;1.8290114855701820051;0.49453596088501122763;-0.58387095321258408731;1.779700493770277836;1.0643071337740137583;1.5069494148288302693;0.47917470313129217896;3.6358300143414328254;2.0023728559854805376;3.0530157928751351371;0.80695554883820252989;0.033959119540697718653;0.20567733974607130265;-0.41738701602336286678];
LW2_1 = [0.11230754753279729996 -0.066747960656035235094 -0.082468500800449567878 0.084968451375255049651 0.064893867779862349221 0.11449271353193733736 0.074000018016669985577 -1.7656179721706202201 0.00040126832463388469605 -0.055548986802993964573 -0.084899227232074589433 -0.12497238351360835662 0.11039297320457742979 0.06672505529980590766 -0.089969609120437207817 0.10121547332945603215 -1.4296626978295159383 0.058781696579967970817 -0.043962907102026958783 0.17986390364678997433;0.02132753707873647972 -2.0944039274680803508 0.014418407368748510297 0.008200437513758918745 -0.0058003922995710022539 -0.054829711171216287402 -0.030311144020607805327 1.3973268540166277063 -0.0084451267105221331649 -0.019568143910531046042 0.64479358174888368183 0.075978117052088872674 0.088732919121313952315 0.00083650519729630209986 -0.0038235725350718174909 0.06772538880365328029 1.5082291948458736996 -0.0071961230926143289824 -0.02954192874684919215 -0.023739628483324743541;-0.0082102034581353171283 0.28006188501937034907 0.015088368406254885207 0.028978363223978082647 0.009494215413139576662 0.010918398444947557263 -0.0021014667651851094698 -1.7762675061667496657 0.0063044207991238268227 -0.0089024032095392814645 0.90833209264227721125 -0.019892807644684751961 0.11222672573349108671 -0.005761903594840104767 -0.003984617371366032737 0.072572522336168718282 0.41043649980501867303 -0.0017249040008185559207 -0.016182079818025697782 0.0038133638000730539844;0.03106945072241114672 -2.6365301616162866161 0.0042786592902794269924 -0.012683528607268778135 -0.014093232998676109499 -0.071918867083394302786 -0.033306701410038525024 3.0012977754546019682 -0.015067607595185569455 -0.015660880157003891078 0.033706133488054880465 0.10255037144300253871 0.015036222457500946978 0.0060048027581005615494 -0.0010294267256597434013 0.021198339818724976774 1.4198833676824422767 -0.0071642206300283287762 -0.021803304847818446438 -0.029827123386069371441;0.0088469235923258303378 -0.089942673807407225173 0.088727778119284311797 -0.14246714825071499222 -0.037823017820369481123 -0.036655180255838602787 -0.043612164516891878396 0.12696170886322985516 0.10062693471268642498 1.3075459357153955686 0.043833374317325271563 0.03916979751683376948 1.0886278932487507554 0.081183618165245705067 0.0030596312326779530159 -0.51269125245639890487 0.030325280836420359654 -0.47046907514571933984 -0.0097609512705956105044 -0.027554584737642780212;0.062173722398002027878 -0.044499481033254788265 0.078538351559728269979 -0.0056731252761696776207 -0.020395273545745246091 -0.027571947235606103499 -0.0022746536341568608826 -0.004035470166873922869 -0.020422023431857633941 0.38500351001551685881 -0.089656992665449825042 -0.02828807362766814007 -1.3370422152792018622 0.023950155647842790579 -0.031459484462848942565 0.95718794448436117506 0.029442532110558555791 0.95050903633042049812 -0.051817828554020388399 0.016681430572748689317;0.10876923722394821192 0.013816056891591212488 0.024110089518971821593 0.02176787135915816615 0.055985134360057954572 0.11565845930535126329 0.051396326335603897961 -0.095296550496706600164 0.0021894956294490758308 1.6650593596293605803 -0.1076879410292463507 -0.015906892359172107587 -1.4076965877571678831 0.034962405226922121937 -0.084746176494358727016 1.285617546837792613 -0.024728482494414477655 -0.83503837001610214941 -0.031385021185562238244 0.061645914642533466976;-0.013614944203087809074 -0.066634380360712203162 0.076743579294289918091 -0.024085904890367201836 -0.073259175391292660762 -0.13351534483316176982 -0.046591782821768498724 0.074654292816909093022 -0.028689490700383655369 -0.92269630466567043037 -0.023092737929276636877 -0.024675801615948848161 -0.4911889691515132772 0.0024146849613787082535 0.032943924224911332044 0.11661073621295446612 0.056554079809916189825 1.9015196518212933441 -0.040061649052355069456 -0.029431058557503473466;-0.57125742463896356238 0.016799886630664451204 0.019623983868196127195 -0.20697201487647051699 0.015006420388155885387 -0.01845735839920861765 -0.00023079092840416694406 -0.10586592781642922834 -0.61570270163266704877 0.01035132566558601315 -0.010326064036890417186 -0.24337518534806221182 -0.04832677726801882373 1.0203276774592500153 -0.119009542635657245 -0.03540408399588508559 -0.021067346644053141363 0.021956928287784175519 0.42555789080408784608 0.20822764174356017675;-0.57704731854800783708 -0.013551943381765962915 0.13766185481628281928 0.072038610288835652762 0.032415796026839249766 0.049239074049263177602 0.013262668469354940357 -0.0089476866734177779722 0.77221369854036814306 0.00014855938951375343045 0.056091800900638283389 0.19817328690299573779 0.017035398366057039055 -1.2941651172873587239 -0.78618665628489503572 -0.019015265514625404736 -0.033229531982273859125 -0.0043199333887087559142 -0.28660128993377215201 -0.063199332247895520509;0.93256749714423758935 -0.0019012357671574948992 0.078952609144933225127 0.046139412729952679337 0.030131951271265996345 0.082243143165743534673 0.027667201495029821595 -0.017905659780208346699 0.53490257908981853063 0.013407695120839630692 0.021175551067363972829 0.067101512642895932981 -0.018736919338514498867 -0.53570772043177528055 -2.2598704342728983541 -0.0057104851557639437973 -0.010051139395669034596 0.0046409611060352134668 -0.11526131743814073405 -0.042695792837948859377;-2.9507390717836363692 -0.024982709615729573743 0.16394167175531351721 0.082900470304801646138 0.020150811268394450138 -0.035240717611906911821 -0.018844267053768314069 0.010469682988523087291 0.77110967390978812919 -0.023759003431701848641 0.08507731433273230115 0.32079942959305596251 0.074289663136664740861 -1.9319142450907027531 2.2714385861937893551 -0.033983183614717693555 -0.058990319196022718284 -0.019362169404653146315 -0.43524059808883175382 -0.059054704398580855351;0.016963512189239023792 0.0096099739686499093677 -1.2545279033266814039 -0.32615273694125263004 -0.0058819294789412002178 -0.013747097442091271366 -0.011575113130782443624 0.00061628813856184254741 0.018887340845185802279 -0.014138715077464152764 -0.0029011379205683245075 0.29733119311867500789 0.014989185008917113931 0.033204353693766536226 -0.011643558127022732643 0.019630174908633491598 -0.002516465854978936021 0.005838477396303678145 -1.2389237947681914775 -2.7371212516319309849;-0.0066358613914711704271 0.016849826313255218679 1.150167426671293569 -0.91008215652216195579 -0.0050270719456688792853 -0.0079591347295222738406 -0.0046699462231765643747 -0.0089014823390648426665 -0.069451765410483090601 -0.0052891605333491671301 -0.0033024434581424930851 1.3717119121727423536 5.8683338862888209707e-06 -0.12017734683526340445 0.0084449868375434736234 -0.006001288495956907075 -0.0010945247693311169722 0.0026101574902494791355 1.3184094631588156865 -1.6369009234398528285;-0.019087899485998243571 0.023996367674968085981 2.2983849682499126743 -1.8751007265478729646 0.0036285738569264884903 0.010156826340785967897 -0.0053722389887989104723 -0.014066676288055728755 -0.022755244411001698812 -0.0048347042736692248666 -0.018476293676304520602 -0.79752273008046437042 -0.020779420485117456457 -0.071993117020123759131 0.010449582656306587863 -0.025526869719995213398 0.00061580289941581540895 -0.0065214523613094706883 -0.13974586124902085849 -0.99464360851224808968;0.0079519083457191327285 0.0040523248970921856363 -0.42289252904021584767 0.38806412183812050154 -0.010719228830733291968 -0.021622086212838242253 -0.001788232500663498566 -0.00096160714987727320072 -0.08281301247916243724 -0.0031667457166323111084 0.010108693253663257258 2.753608673671458007 0.020882446034759503256 -0.1087319485855804263 0.0038894961150900981411 0.013682767908083190433 -0.003822571117063347599 0.0086571909824696008373 2.0724688870683207753 -1.4945265693666860418;0.0050274819146521104382 -0.0051027153427136359709 0.14827855173838108693 0.042509729710270553749 1.3572953424147859991 3.8080194319937339387 1.2781640939543257307 -0.020289029849298815394 -0.015584935822165338695 -0.043772339921804716278 0.0039888365343213804878 0.13099513826484993073 -0.081723583829629950492 -0.04139911533155514467 0.066002158155844814491 -0.047132959608289809461 -0.028935133274034397638 0.0093465081484115260235 0.19871260974809543121 -0.025606118207114683671;0.014395027961131699745 -0.039823212581019187817 0.032832949923956598892 -0.018749057668774184865 -2.0916395150542226311 -2.8987245123252129986 -1.6948739302074373736 0.12637035890265041482 0.06810024433402206423 0.073975937673017133633 0.089325463381571865162 -0.090468513992251739508 0.078560211158393955522 -0.051228021351880995149 -0.01731249503935354192 -0.071936353254876073127 0.094466936028950662663 -0.030625573373357924123 -0.16528726019155079441 -0.1283783968624252203;-0.030487478264402560757 -0.13594230987095456964 0.046282472279601548359 -0.16337190610739871222 -0.79418172854782509429 -2.3680843313620134616 -2.3576582622059878425 0.19262848579437996666 0.041494537099663011959 0.12321561541878210677 0.11735026493465877673 -0.11618470016905696474 0.043111567106936615756 -0.029566215453258343909 0.028816604378614461834 -0.066943765578191663512 0.16545382284694701291 -0.042824234944763908683 -0.27255099012643130285 -0.35748031036232008617;0.046445440552831847303 0.045892620718437457383 0.011957757619532308549 0.09707064098697537613 -2.3630801413265474231 -2.3116923463407395012 -0.63738161148469796302 0.032532953203791403762 0.066809905859408394435 0.01501759382330480376 0.040328428538336777431 -0.040135605699936002799 0.079513375299900337922 -0.050126819513132220285 -0.048627561165403530852 -0.053430953359380368994 0.0089077789594069617385 -0.011885326517015730452 -0.029402640076459932855 0.086475414480167711595];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.0188117963226564;0.0103195590851694;0.0152433032264625;0.011915029151752;0.0167498240778173;0.0125203638148894;0.0186505694634926;0.0157615369458884;0.0115761231484842;0.00821103495218566;0.0102874622189846;0.0183862770989852;0.00950637708368752;0.00746116948320064;0.0119517615856925;0.0110126037227308;0.017024234406207;0.0113844845954145;0.0218269945750798;0.0162459507455786];
y1_step1.xoffset = [-40.2639117995613;0.0406314994409192;0.000111450359302022;5.59364054654817e-06;-40.9099698880564;0.0375603899322074;3.10599224499654e-07;6.61906653990514e-05;-64.4694519771506;0.00670902388685832;2.6972517211661e-07;2.63718422563581e-05;-77.1108639352254;0.027887382859933;0.000162164860334779;1.14981057367649e-06;-33.9119082180647;0.0374604304406662;1.52250802892828e-06;1.00751240321817e-05];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
