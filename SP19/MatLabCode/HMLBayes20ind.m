function [Y,Xf,Af] = HMLBayes20ind(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 03-Aug-2018 13:47:44.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 40xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 20xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-7.20412376055846;-7.39780067872331;-5.55830269429961;-7.24001864979615;-6.68392606777356;-6.15986866723232;-6.81745732103892;-6.43127639367199;-7.61765814676861;-6.26581180977802;-58.4459084600351;-64.1674476705702;-60.872871351576;-57.9841988415141;-66.1654309578848;-50.3749823558919;-61.6568589288019;-67.9133763420701;-68.9726910307393;-60.5147501502716;-72.053568367042;-56.4254185933126;-60.2540045204447;-61.5287341063893;-62.7847565445877;-55.2926012708412;-55.6776522942131;-60.6722567601028;-62.6804949205229;-59.749449318716;-63.8073070796973;-50.0039296316444;-58.9177603069967;-76.8751286232983;-57.128495376367;-67.2870072882869;-61.5450324717635;-58.5790529086585;-57.5692616568886;-62.3302269937956];
x1_step1.gain = [0.098373339792964;0.115582987985902;0.118632135693981;0.103300367244071;0.104372826727873;0.115404627857101;0.106840162314159;0.112545854049226;0.112922355483068;0.107538026053789;0.0153488608757517;0.0158230428173767;0.0139857913089498;0.015237670370594;0.0147266805519896;0.0158357585926699;0.0140778671790345;0.0129871767997161;0.0145983134454662;0.0140875076064795;0.0136585255633416;0.01548355430311;0.0136876151579618;0.0143188793378985;0.0144093551478829;0.0159454094416016;0.0167454711044489;0.0146339094320244;0.0147095851661692;0.0153030374976467;0.0142871708192766;0.0159252944171381;0.015455516436242;0.0139455894090691;0.0157428371701136;0.0131160495148572;0.0150173570916456;0.0159250303590881;0.0157990675194166;0.0138733567384915];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.0505386097769657816;1.0992796563142410715;1.2165259635494993784;-1.208132719111308484;-1.1283734829472287231;1.0014763772761823279;-1.0775715771087714945;1.1287846863962047728;1.0799882563091405263;-1.1721978904295025092;-1.3648366160658831348;-1.1308395440648253416;1.1786048666674298069;-1.3387906254427970332;1.2350050761055682003;0.99053931934081074218;-1.1392630600786222139;-0.96067226065734401264;1.0573784860197927848;-1.3198676161028022324];
IW1_1 = [0.026273326757313739122 -0.012769376012922412089 0.015894598704868031364 -0.013247295862377888795 -0.80429254844226927279 -1.4892851169308196635 -0.031958712871526982757 0.015010165910863498134 0.014261646816309835051 -0.0065510376009935466016 0.0026732649498181532306 -0.0015805503219922427752 -0.0066165190667405544486 -0.0011340043170941036671 0.0051203760305178177073 -0.0044315800728546798221 0.0058036645919527412099 0.0064143149099396210011 0.00023454147611005942082 0.0031323984845490196113 -0.0086718383235083237176 -0.0075096813214192252584 0.00086711005380293274154 0.0046866427792942753558 -0.0025627910683533512183 0.0083950402461392022169 -0.0023870575468339983762 -0.0066053184625850863351 -0.0013492593655746070499 0.0019917840118322894041 0.0083538306027662930647 -0.0028179246384361267448 0.0027847824420499786222 0.012110196535566391737 0.010851341960953239316 -0.0071067106686793250422 -0.013323110189376157972 0.010412200746663680465 -0.0043214142636510636392 -0.0041766066382373104662;-0.004242371567419430875 -0.041328288197287864347 -0.0028294459415658407969 0.00092196191573010459648 0.034319382699934820879 0.010889672044514266819 -0.951415407192723106 -1.3039084571680241709 -0.058376931422425754059 0.0029049868129040392478 0.0024225014245244395547 -0.0048521733768801707243 -0.0051053842976345456192 -0.0058924185221887236466 -0.0056897000909268378999 0.0090291849709847379207 -0.00017574167222790800587 0.0027715351825260787708 0.0053424227777860771801 -0.002082767455346535776 0.0068797525846650770323 -0.0026963326243515011241 -0.0072017215158196581579 0.0022308374116472308966 -0.0012607453213344950015 -0.0094872980099304990431 0.0048518173771850909085 -0.00074860956426319781327 0.0041622038724556612715 0.005790403211014852683 0.0013912058623334587221 0.0013261820031767225254 0.0028967850619600987554 0.0088246024418819225127 0.0035061683866167187192 -0.0040621500376370892407 0.011019061377370152621 0.0017226134273832774315 0.00077152103767740432948 -0.0021100528217889084719;-0.026686277046206054175 0.032751003510930645768 -0.027839194219271889974 0.01571073434721977774 -0.033360587283097459244 0.022574370668993030964 -0.0093179028391958875627 0.022001766851891497306 -0.679994193432276961 -1.4204874434049306053 0.0030097666560311361894 -0.0028372330187912435037 -0.0033156514853575165189 -0.0062968507381920280075 0.0053711545798333752699 -0.0034478387350150010646 0.0047262735616475917352 -0.0011233085778719702728 0.0030351236617811266742 -0.0050270384257822585752 0.00070345516285421391244 0.0018423565698244613424 -0.00068922907069441372626 0.0075776332640194723686 0.0074792655115294703894 0.0088798307508140394279 -0.0038915895180328340629 0.0050454410902542792122 -0.0037844838154370927935 0.0054755290856776800412 0.001541839204664903441 -0.00095096652277654571475 0.0044280380649337645546 -0.0042596736568144642071 0.0070451999461067392125 -0.0015704405147716035858 -0.0036393847666826950431 -0.0027866550662381493753 0.0040074659392010884146 0.0028819064077083961749;-0.069966525407295115935 0.037091556760283861394 0.45807405389257410677 -1.0334089947140074894 -0.00052711766388498248505 0.016008732158048089717 -0.035463356436608521605 0.024398133505060821957 -0.018324280549299777621 0.008290140560463347269 -0.0041291157895214959661 -0.00081359900958174872533 -0.0019484207732695401662 0.011156691104265457209 -0.0019759385198895138176 -0.0024723498612784738752 -0.0033628768638275757623 -0.0005499535232940103895 0.01197893972530390122 0.0077917359357189634045 -0.0015379402561429985317 -0.00020637218244524505061 0.011485468778432419631 0.0035818445780177242226 0.0029261531311233156781 -0.0040980870102684426037 -0.0006296446126497829603 -0.0013506927031758843988 -0.0044250431563398499521 -0.00036237132282920748918 0.01118823122292218579 0.0018150211585205426081 0.0022903717722885354527 0.0017955192835295318617 -0.0013467381854100140496 0.0080044559602937322834 -0.00098549326223740501413 -0.0070847366722082130361 0.0069590772945229235555 0.011123858478813999223;-0.0045961820362145269087 -0.036433299824951262402 0.91134070419303281341 1.5084600011551005938 0.045365561899074029195 -0.017879370174347899297 0.016962942318933030977 0.017100238194190132968 -0.0056667114081826739161 0.0054909117798133079066 -0.0033878418525297090969 -6.9714176255937271472e-05 0.0094159818520936598707 -0.0019175033982016152171 0.0095216447889958054362 0.001323753522068709873 0.00022293175715679851897 -0.0043976518619657694112 -0.0042816352448979437192 0.0026441195106216572666 0.0052284535464477881542 -0.0046046640054235440584 0.001080666694035375703 -0.0020920300033676958104 0.00083938421104528355629 -0.0061882521880538459216 -0.0037236299437968436304 -0.0026591402429661566836 -0.0011914658105649862836 0.0017087108764797340633 -0.0060444034942576376976 -0.0028233415035228549665 0.0074918847572538289567 -0.0078739059199155123081 0.00011933141999989982178 -0.0053052201623800272073 0.0065264845422453058796 -0.0027363219556973414695 -0.0085782353443579588415 -0.007944159519358506838;0.058459115202130908229 -0.023957751440704534718 0.0040248561122248251859 0.015753817110232715137 0.0089075107163331425364 -0.0056081421764031897867 0.13237357535512800366 -0.038207928217551270778 1.1272127555554847245 -0.72627768573242990069 -0.0099531750098969598572 -0.0010171718151855508802 0.0032502394721130849903 0.0047032430740203369154 -0.019434753584979362617 0.0063252273758922072239 -0.0026457061320554276299 0.014895787594738014656 -0.0072695425251759282839 0.00069939427623138248659 9.5618543254437059491e-05 -0.0042036017361568580805 0.007243896800963060302 -0.00065582820492959121011 -0.00021100671640715470143 0.00035259396526710062858 -0.005963190216069620686 -0.0068598255959709131951 -0.0035109590789568082339 -0.0097560719639440615647 -0.0059594012496599407455 0.012653423219630645716 -0.0044476706217743255251 0.0029715239394510735774 -0.010857666100972041684 0.01743425678166825657 -0.01355801857834288901 -0.0097510633158237516177 -0.010076924691809090173 0.0062257258366332501875;-0.012069285811852350013 -0.0051844988241912491611 0.025340284462278903771 -0.0055514297156532615637 0.054790192337457348237 0.022993514924529005056 0.8186399397325047067 -0.78648834542222034738 -0.049184054887648438747 0.026175043115904281232 0.0060021389967044817132 1.6702215079717657245e-05 -0.011475116727714500253 -0.008144849100001752551 -0.011851674224259756141 0.0089967239763484273263 0.0033685148303731829444 -0.0013787576747618596543 0.00025868590082986131539 -0.00089544503084526246364 0.0069932615999253600059 -0.0019179228953076334421 -0.0079044521872739526014 -0.007630017817755197114 -0.0085717153292884477878 -0.0021501792029731078316 -0.00039741401956409688409 5.1197054234450729534e-05 0.0073619134466075151699 0.0053979535885897902275 0.0073554812970248722309 0.0043379211108916090542 -0.00038728241139998788442 0.0038118283806951283772 -0.010386745457388737307 0.0010779669244347324028 0.014962120484783405019 -0.0026694910538484642806 0.011466049400074965203 -0.0039095411559647462105;-1.0088259789426496926 0.68534380018710594484 0.049452767813659870288 -0.018027584229365799934 0.059814492502210991898 0.026793563038998532977 -0.032568616538862227294 0.012864142932553055895 -0.033827058319479338944 -0.0006130776829664135244 -0.00084518299701628657374 -0.0025170690317379957289 -0.0018594846735550062643 0.0064282491568861104686 0.0035667036871307915627 -0.00048522410742894418701 -0.0029182210159746676918 -0.00047102765201729996205 -0.00083435150831145216913 -0.0053600618088333164615 0.0061030497118988343008 -0.0053275581502002884379 0.014446219777568014911 -0.0024635443366617252106 0.0066019466194002342577 0.0042326209761159678743 0.00064256284719926577004 0.00661790889325449775 0.00093985200279429140929 0.0048830308830255172992 -0.0046677434926974898169 -0.004574594267794100666 -0.010929787007198986035 -0.0051262336423998026286 -0.0035752872695431156015 -0.0096632739825838771114 -0.0029491041031821469895 -3.4837276418332720435e-05 0.0041110735345871000923 -0.0073065724539889964628;0.021167275417643870161 -0.021446728741184011707 0.071470627436862541049 -0.014196949588300472947 1.0803896861819923814 -0.27438148121609129415 0.084518563329116724869 -0.01275772597501495173 -0.007082143738130283403 -0.018844850107742453643 0.00082150527901185012563 0.0017516751304287518469 0.0084855738262916476783 0.014869976860620394421 -0.0097943228903330497442 -0.0042687235703374112883 -0.0041855634483248579242 0.0042860134565600510256 0.0028854475683905548601 -0.0025775185865327889141 -0.0068604657991476851453 -0.0015942958488220032674 0.0016715733278915407244 -0.019537333758402906925 -0.0091089322470850452723 -0.0084348756732631792465 -0.0018406477169042741691 -0.0011611410362149686068 0.0014379298715478322848 -0.0089692277618118650823 -0.018532230265519637757 0.0017375356141368469669 -0.006341472416860492213 -0.013496091234858386201 -0.011389777277015891363 0.0069035013796712296069 -0.0077556032870351020864 0.0014624204331605944983 0.0036727733149846384687 0.007049683010975991114;1.3662323413381805004 0.76663888933689516847 0.042025595134049575918 0.0022869320904670268658 0.053498293965883389478 0.032240207269078224872 0.0042205051558416584179 0.028185299596340560729 -0.023430844945708441396 -0.0023965023408388636504 -0.0018416478333855273303 -0.0035854745055656461576 0.001885360773506231059 0.00031079374034385156287 0.0035305274758450104142 -0.0057247059003245363493 -0.0049639831202245620137 -0.00098605711176331239942 -0.0026490487830672713836 0.0037325554526771911185 -0.0036896229039743762973 -0.0093929416817850434895 -0.0077340770909187176591 0.006132997344937741839 -0.0044819327545449578684 -0.004513644949028669702 -0.0069751943342155273142 -0.0051411232344976444397 -0.0046920757878953630801 0.00044003722922459720477 0.0028661387373187991769 -0.0049718255430500641473 -0.0058381925733119273067 0.0016110302722999315754 -0.00036215588343901130826 0.0019036293476010176292 0.0066538715640790703498 -0.0035530253248683687714 0.0037679316257448053351 0.010827211996152915144;-0.071542320124295358252 0.015962041672269878384 -0.012515276833797018066 -0.035524782205210124475 -0.00066158367620081418546 -0.00034936745537900653442 -0.11477824942903468164 0.069252331267237926538 0.76996863911498969468 -0.91364414459571796634 0.0087764330736153622209 0.0025330221016571802944 -0.00071937516019658729466 0.00053795880753466560325 -0.0079786666768975975789 -0.0010145559772346043198 -0.0081198313810317088862 0.0093614475390916742498 -0.001925044223590401506 -0.0030076536465032969667 0.0056100499047748754455 -0.0005962943946771575264 -4.9492790763242849774e-06 -0.010182154449684075251 0.010699160647579464972 0.0093098888549044082202 -0.0066621915764090954004 0.0054063645533408734301 -0.0033626797999497114351 0.007368344677174457763 0.0039387428685381089058 0.00078459275389185310478 -0.0028506772028109106723 -0.0019361132710715058935 -0.00051920010119016523145 0.0080150797999805692418 -0.00037329033127367160618 0.0010155299011418825097 -0.0086315586029256548273 0.0078583614931544941429;-0.059628008682124589157 0.013259481061763337545 -0.62444558050283915929 0.87792572765213006125 -0.016133086440476344242 -0.015179006072577853545 -0.022999153272797903669 0.0028378543971475005472 -0.04631526693855159138 0.01540368141636719139 0.0044952551863252894829 0.001148450293815069358 4.5683269618182903923e-06 0.00034682173430645096357 -0.00022694841341459437 -0.0019797229472707060516 0.0070992619776491629538 -0.0021614440772948035827 -3.8782482189320097751e-05 -0.0056823377154713080456 -0.0022357665222159143169 -0.00099158993328350773615 -0.0035377832170577598603 -0.0021221098482499109114 -0.0018983379617945397855 0.00023881187883363711724 0.0050398093968286993699 0.00075501219168836299165 -0.0030866622022867953867 0.0049679815703897326276 0.00011653319288081973189 -0.00067256750802724939164 -0.0047245880150992083935 0.00015932459660893374584 -8.8506064353256945032e-06 0.00047121223635244660751 0.0029156665425626275556 0.0078737577643341206263 0.0010440734999729588302 -0.0031315928919215208978;0.00977343824012158989 0.041681530329667010326 -1.7035950881862802486 -0.49219846898953256709 -0.12615284530642942307 0.032357089451223716714 -0.05396146462258767651 -0.024844227835741687638 0.0076394675011319723365 -0.046579594998307952136 8.7589966456699382634e-05 0.0034283398486043732689 -0.0078785953440599059555 0.0016150325614768662724 -0.0027178532210549552657 0.0006689678248975681335 -0.0058041306215289266424 -0.0076549062001550587098 0.011694016998087520404 0.0054540268864822693748 -0.00078244194732307787744 -0.0049731105927311499565 -0.00078225963273705317446 0.0044410052728212009998 -0.00019957192330682875622 0.0038276736174020459073 0.010145259688996046202 -0.00079001394075011669577 -0.0053771129888786880005 -0.001146732009650511426 0.0078709194279391238996 -0.001595206313492839598 -3.3313716688983195636e-05 0.0062795208222552406988 0.00020037509493137670245 0.0085215477098872938894 0.0037020320786844860758 0.0057140425785258382521 0.011008823631760752265 0.0095160044815991925993;-1.2691495746633940644 0.3499087633243667117 -0.059673757226102408513 -0.041177294230936169195 -0.037573352730242787212 -0.0085526488492955240334 0.023941388847320048405 -0.035572171084995884982 0.0057604735192919977529 -0.024864881004268674092 0.0056672923738166651117 0.0059619850029686768944 0.0042457309747662838259 0.00019656023630567552281 -0.00081920240399569051962 0.00073808069009453523487 0.006288531307837050971 0.0063559518786895545864 0.0022751579180500204266 -0.0037171963133050107096 0.0038697356357668090052 0.0093312708645360790266 0.019495460721413275518 -0.011378919417066601233 0.0093590310589406512654 0.010319017744567287806 -0.0046579810950228648508 0.0068208614312506186603 0.0044126387786662703283 0.0075238527776842634848 -0.0067600044565305980604 -0.0020605343017871327604 0.0029327824351032985399 -0.0038924467021626499991 0.0027816657983604146757 -0.0093208473644441139361 -0.0085416957351860250958 0.0077643933391053458759 0.0019303857164174949464 -0.017433499278095367785;-0.055105596687967446645 0.067339600817288555734 -0.020025770881957276337 -0.018297673493577613218 -0.032492367810595008948 0.003072619663728849617 -0.015887175473183835772 -0.0029286812451363420338 -1.6347746432296621499 -0.84847829646378591928 0.0057489920560474866082 0.0012628057233820498811 -0.008875191455803503604 -0.0035098169411053744236 0.0068804083538811164344 -0.0060145807129131688765 -0.0007224396745681598616 0.003129424799011556145 0.0040060403549466083381 0.0066086938707661194853 -0.0057089522879711241538 0.0036593021216802107398 0.00024631742199347593644 -0.0026263502002309021231 0.0037264093054551424879 0.0029794374389130419065 -0.0048803184257428140758 0.0097832068448424278073 -0.0082538347007916085946 0.0098805437231476982846 0.0051805274322677076146 -0.00033881662018086692407 0.00053400872923413205112 -0.0049340282332152171282 0.011888931705034350497 -0.0016592359895791892153 0.0029095242290267486589 0.00661415266108202754 3.9801357828342640618e-05 0.00019118949628924237008;-0.0028637173737951359016 -0.00017466603615543170071 0.017087868133718785157 0.022347303862439289041 0.030963281616050362249 0.0091120033797317551844 1.0155491855314975336 -0.43371332498917047893 0.031541214973165268565 0.070681205071788349992 0.00026950485929673055922 0.0086988432374158954768 -0.0030204716661082981269 -0.0022268010135738157233 0.004952553869342493989 0.013746741751156225583 0.0070009793524909730983 0.00062387944647877412608 -0.00034712269698777299936 0.0055324482346300095717 -0.010612135003476377143 0.0026401073935981103115 0.00099523313706769800206 -0.0028264891925970495913 0.0013668278730775294729 0.0035962452579096654964 -0.011829225771790947627 0.0052072592116599748097 0.014014616650024368238 -0.00043008743740896387096 0.010069482992788163569 -0.0022607074968163708498 -0.00016204716458421522291 -0.0099353959736543304149 -0.0062870124594279529553 0.0070779601938959465016 0.0054821625819161268894 -0.00020374624437435713228 0.0077273900078504162772 0.00058279422567743168881;0.0093336410915352552298 0.033061815662195036258 -0.0086069878934712518159 0.010820222439433877307 -0.032783306211516934081 -0.010288742912221413017 1.3611106275676871924 0.59308644752430628166 0.070368863445915572075 -0.035829909808467286236 -0.0039446872156643827262 0.00095849420081567577624 0.0092746251488879556668 0.0045201001064228236645 5.36319631000112566e-05 -0.00072902068564930765787 0.0038061860450528889679 -0.0052528729594634587796 -0.0054711080692463887054 0.0047737765635167250106 -0.0052891424255182284409 0.00013192137719206047629 0.0032061415174153514752 0.0027636016411326847809 0.00057726592488046657523 0.0025500893744245514347 -0.0046815832484971304367 0.0024470182059651407989 0.0035420199773852213514 -0.0072425097866879008593 -0.0058222298454228315137 0.0015213252556887620678 0.00083876905098216624802 -0.0016098165680012588991 -0.0015832362318489241922 0.0044419365746827341873 -0.010208912328696620811 -0.0017533513574177156478 -0.0083018242758193753345 0.010148259406565923041;-0.052244176725592166022 0.01758023755163761262 -0.0059115057911824139131 0.012040774659545692982 1.4140572071106063401 0.84098395170756190531 0.0556332183144918474 -0.041152276878751607725 0.00089105906257449889445 0.0086886896398912418643 0.0025479794047964751148 0.00088115750430208103147 0.0083186830553051670234 0.0070355093445577526756 0.0029489129526258646245 -0.0016066544723057965809 -0.0038842508572391395982 -0.0082937954405489511256 -0.0019273142449245093434 -0.0030185021251444145267 0.0060149573388951823455 -0.0040663146126772116082 -0.0010470598865226911182 -0.0073107036344855222745 0.00062828891635467894444 0.00014553582261819604971 -0.0039448678361491259711 0.0026748265347149120449 0.0011038976733119254797 -0.004210061826416062504 -0.0023229341681756734972 0.0037414369271256478489 -0.0012798919973133167979 -0.0097785662031699468327 -0.012342029875696122407 0.0066284376981714451804 0.00090091500950544446246 -0.0043715516903855538428 0.0024262678972561419616 0.010090615927086037107;0.012399834057350834354 -0.018440810675658184103 0.020084035031981396779 -0.03048141836537704083 -1.0578207521908848943 0.7377821235924173493 0.081409818028158012493 -0.058755098511818329432 0.037795601549853924395 -0.024530539023584749247 0.00089393539616046402418 -0.00043932080666681829189 -0.001158286722557585937 -0.0047849959335214626091 0.0011335763527811940857 -0.00061095660859241133957 0.0015419233288917547076 -0.0060221506443077282497 6.733557948204217658e-05 0.0064316492417399503262 0.0078105067120013086518 -0.0017184311492378003677 -0.0012723713599632816267 0.0058008350178105618986 0.0061395548591638045288 0.0040184055881911850613 0.00023300644401709827425 0.003377010707730388351 0.0055341894758278034963 0.0014290640978055525745 0.0062470218117929143115 0.0032618615610768317108 0.0043913854379558584645 -0.0036433992528015811743 -0.0037082649766193354936 -0.0083322342226856867253 -0.0014622538852215722065 -0.014065379899028255736 0.0074982561225947633524 0.00027574585316333672779;0.74201583132157711287 1.6339292321634817373 0.042557991295671997178 0.0049893358591575082822 0.025618461692641255473 0.044322380953417131466 0.022267018200894137664 0.011832292523293203371 -0.023585176113043407331 0.0038976585011439917813 0.00055015069396401733697 0.0036861565567656499713 -0.0042247419575690958043 0.0070596862628231954115 -0.0037416298573395233816 -0.00031331998454685035076 -0.012752309766014718537 -0.0025625758859675485529 0.0032803818432288502083 0.00069603600256652189363 0.0040274796477270911887 -0.0073729569798265453748 -0.0006816702707364149464 0.0015652308297902687521 -0.0039031192631458224394 0.0013558241537215435721 0.0014945322941241916039 -0.007185974927349432842 -0.0011028970483207814392 -0.00058091956133349352109 0.00064620513444023505115 -0.0013434296162347018726 -0.015852010575600584269 0.0099749161402753732525 -0.0016358610062925358925 0.00067636713131713434213 0.0038493292459474900968 -0.00045060939268031955729 -0.0024330711233376688292 0.0043529323122552992034];

% Layer 2
b2 = [-0.74652063408537738809;1.9419941539803056152;1.3589031118489871552;0.84962371010921489134;-1.2075448487804651965;2.5476359812191846643;0.78809096352563656751;1.4787962361192756866;-0.4699169779201489705;2.5067275328338829432;1.1247785947948152341;0.80417914334866935633;-1.0763078102714755957;2.2752053384041062145;1.3674388770127381409;0.79029489617666348611;-1.0136459875720136292;1.8070606169352581016;1.1286323122892127913;1.0843950489118956426];
LW2_1 = [-0.021993423410101877596 0.047225190458408047856 -0.04185038640299204582 -0.00039765854017398448786 -0.063324200927486501422 0.016237711661911895245 0.0038895816878311314894 1.1215888291373401486 -0.0075257325361225415813 1.0213214884265928717 0.050659020756807920938 0.17788137648221796772 0.0016872447506253681389 -0.47109038314040602158 0.0030818875556630296458 0.019116249182877860513 0.02722653182983768988 -0.09773258784433970503 0.016159327820972162887 -0.2489330456514035339;0.033200029892935314924 0.013597027606313582052 -0.040708594791933012946 -0.010073924618191145569 -0.024549657914164288441 0.030322079523582221028 -0.052911084637413730025 -1.4307725964902249238 0.050556965550232424444 0.44203056026461973183 -0.014328887276764502162 0.019816282381227668524 -0.025493180173066908728 0.94798393756173682245 0.036641765434855755323 -0.0051094971355349887848 -0.019353695214604768604 0.024033137849310041989 0.017920374943915007987 0.71983597718259850762;-0.0065322295868409027686 -0.011803492379969070594 0.015833956251571416202 -0.012214383429768702061 0.0026136564805134664818 0.015527738686386073977 0.00044470560259880493985 -0.93642033562011139924 0.00021259724116582312189 1.5528297441470111373 -0.032415714973540156463 -0.018201593897953376872 -0.0012297280534272270799 0.91716670433681513064 0.0015360539162621751879 0.0050894242540378119982 -0.040102824897960714923 -0.0066655680554303349886 -0.0051115033087715568139 -0.55715179345675358569;0.080356770081989103982 0.049863687701155616494 -0.11116633468338278645 -0.001004887636680672474 -0.054319239674446018196 0.037770425023772515039 -0.11220646452935537085 -1.2741074224986013164 0.10748985744370442852 -1.8147001938696631917 0.024802297404348073312 0.068664872854935887769 -0.047748937745815470124 0.32727153692716665079 0.073933947693765988962 -0.016633893677499313885 0.029907113195357222513 0.059577868820245544201 0.048621301148217270505 2.4452079389113476893;-0.051771338087310318776 -0.013051936629584072469 0.013478060603813981494 -1.0344434064543202023 0.79249466853758387952 -0.020950100724481217351 -0.018600733417702606382 -0.0028947710643683413623 -0.064238420088068529101 -0.11904930880107685021 -0.029346669165002194773 -1.1919408375646658449 0.12579291126237060472 0.052628742999573444039 -0.008941183575237206943 0.011708760589771348426 -0.045638380695099352302 -0.043086949343393361744 -0.021019615842148037244 0.1370826208467471885;0.047000777338047812492 0.008458889049165065066 0.034667616591074194854 1.328784439682234364 0.65730751368875317553 0.068029990842313384225 0.020071097211526084392 -0.053001866509340550548 -0.10906978278685268424 -0.0036259045948001202876 0.0064438750113124006191 1.4867133959178726599 -0.72156954174505794075 -0.091158003361821351995 -0.023828007091599472805 0.041857293529542281829 -0.028044329010433764748 0.027655828259366622285 0.05022296630079511881 0.031765165521992717867;0.060707916779769423299 0.0072117250922950773898 0.058681280365919775976 0.3157908605281516401 -0.71579028675288958183 0.040304974086711603531 0.027773325104942635927 0.023921314792484871942 -0.16412295112051700219 0.019441303005729115155 -0.0055065979230278158663 0.75698223613022652678 -1.73285396220520993 -0.065495372892831069112 -0.014439809792604079222 -0.013262354059848317778 -0.053110716613945369025 0.02029385305611262208 0.079137024933136443372 0.0074472130960886433887;0.00060766809514164576555 0.003296472827234124027 -0.011618244598557127267 1.2354350224085746124 1.3694059942465763857 0.042033228594334080819 -0.001144542616600610109 -0.081121313357939914268 0.018528182745619958816 -0.020966824000774764158 0.012363991356230634791 1.0309118649132904544 0.68656251998099271372 -0.046483961697966626192 -0.01456965544417546804 0.058985791955381172702 0.014305152792724474403 0.013836774302697195035 -0.011925538902633958313 0.029634215269909561924;0.26192071076492423609 -0.084760824357092617864 0.045913963369594690267 0.033292415185630357122 0.00070951010411548197116 -0.0032053570219305548526 -0.020995491042913975999 -0.041160913083492046971 0.55313257564861595394 0.10697290315360580282 -0.047514549276197984296 0.12445940998963785085 -0.0025897365862219694395 0.095663497527672849974 -0.041829132515288754146 -0.25429385025922468522 -0.055084448455165566094 0.99124261586403727975 1.0330340578470829094 -0.073129091780429755776;-1.1092802223191409183 0.021413177220386353516 0.013635062510247717218 0.073243938308500650125 0.024147710038904025148 0.029779737394594933686 0.032354950919324040881 -0.093266499736166366685 -1.2636260663206178023 0.045124484493249496231 0.017042412052728585226 -0.075568396890729666593 -0.024679004416741510269 0.0085292699818636276421 -0.007034623441510115191 0.054721697492796060602 0.04175849875207557349 0.29716169450765050897 -1.4482512956210984445 -0.025477354974884899169;0.74990460855754903502 0.031661825930661989525 -0.0041724165818412175394 0.045949866907819089668 -0.0079445625774038838851 -0.010098184520247469736 -0.0027866671325191159567 -0.065209519862698933634 -1.0007576329484708655 0.023469470798094048403 0.031010163846878827792 -0.051044192493828771662 -0.030306190521846788216 -0.023163589526021426124 0.017730495885367986153 0.017038261802757036917 0.061151386173324683015 1.5181895632290427489 -0.79616444738466851661 -0.02011306821187217389;-2.34053282497476145 -0.012929713988480411035 0.021879611952171924838 0.036429067989514417325 0.040550609600137302313 0.049329477637997602713 0.045977772617973526603 -0.038046786870783382006 -0.35461086151125392751 0.028090711454303900901 -0.015641742002848079557 -0.030952918782903890427 0.0062699671991051225683 0.040725150172731913734 -0.031105188003680509651 0.047228525973855461917 -0.023518494021647438214 -1.5154390295858353177 -0.8424632597007061241 -0.0068325639051208097302;-0.075813826515444979193 -0.10839931148905987413 0.083577807986190147393 -0.052399522008238802462 -0.044918915987054761074 -0.088810836448679639221 -1.1768433437162910682 0.091376081502409917112 0.058119623293261424291 0.068245549222965745662 -0.1646666680577539843 0.012242176179162123084 -0.035148648080766835278 -0.032121020714627079862 0.0099312735267752631774 0.66542953422589568024 0.68904275844934226303 0.0029774649367361634422 -0.0010000750231742663345 -0.09364196407927659338;-0.021992023276364940781 -1.197356310759312592 0.043203293102521724001 -0.04450551059893070871 -0.027898705574599388241 -0.018630571795015919701 1.4970291892636913289 0.036303747646737917487 0.018001104375163647087 0.015891062421593715737 -0.062447669403597264037 0.033216923441654166993 -0.012477247070630231168 -0.016000411098734221294 -0.036948712753044302137 -1.2292989327792660514 0.24819926623280708089 -0.027710542176871529041 -0.004877442150195822855 -0.041941973261371542914;-0.011462239404134284132 0.92129215914382411867 0.073394939029433434174 -0.001284596130837701829 -0.0087189131859888718834 -0.10680615464962743555 0.63156846250035170165 0.038765453017429618576 0.046944359233601108683 0.032508375500724800977 -0.1230698339447804518 -0.014541707525857596253 -0.011286786520764521824 -0.024732078785513075814 -0.087854703087304322762 -0.95718885910091955349 2.3132624129583843064 0.0042549708249503470289 -0.0095321781065354424523 -0.044840221744161627704;-0.016995097858101663318 -2.6229528408238702575 -0.022537520941427746646 -0.058946012933743865969 -0.027989925446566123191 0.093151225032039319807 1.3148351555713315708 0.0066167830912634067672 -0.026806338656926820968 -0.014608983253027991653 0.051016014385986380164 0.060178917436632881066 -0.0041336430183035411876 0.0052181484169525798114 0.047332133786276223142 -0.59801927381365371783 -2.2120307050354330869 -0.042322077818672532157 0.0044393155311325226131 -0.007091385057141074387;0.032653486045479664102 -0.078865544724814357069 -0.2480157830207294356 -0.017517427053490908229 -0.031552286461767393988 0.66153676586224552381 -0.0061596379627561915343 0.079141620869879664157 -0.051506835909280485053 -0.069695673682797776305 -0.97205586057475479311 -0.026584758221779823673 0.021925220305297102308 0.076028956376528705752 -0.41013989723381982788 -0.10361551184241399315 -0.10831579402497029663 0.018582146177087439237 0.032602759458061549014 0.069309483293644919;-0.0061257831238601097648 0.026754118338556339557 -0.87886379862655317208 -0.027940192556901739113 0.005996158092959543405 -0.85991113382384443131 0.034811381955501347063 0.00071306757860541223476 -0.043637680647278645485 0.023910710106118150675 1.0653987475328619006 0.0085655747073216884774 0.0021950617408461013669 -0.015596253089882914505 -0.41873104092652480013 0.095168765979216474182 0.071352995090935011913 -9.3232876358540698984e-05 0.013188151927914825226 -0.0025273581489339939921;0.039367638933231738352 0.024381245806472651855 1.3856085153866286586 -0.037061041034418422402 -0.047598020855891876035 -1.1916427241752545196 0.059619792605483654113 0.034729741827311047531 -0.044465765420090737348 0.020261395299288914584 0.93949962328022751379 -0.024861526657023468728 -0.023086549544530585165 0.017557067026785971864 -1.9701711130940955385 0.17847245039763867669 0.0025157993714033906676 0.020620535091968171526 -0.0019640912360449802772 0.022214644068415650285;-0.033017991901484279593 0.018062242873479659316 -2.0350629763221301793 -0.012070800250897925285 0.039371293892819597682 -0.27955444225517911416 0.0012708985649299033276 -0.020200885069983909315 -0.022423858534289239225 0.016196185501426541009 0.70816581396410283045 0.025327623287051004991 0.018902388918182140565 -0.032794414133473941131 0.79528801033308971213 0.0021271245173943350432 0.087586964242602996511 -0.014267115012829229351 0.020103209083733333123 -0.018747701894304736464];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.0130948757112039;0.00995686289093056;0.0116071888731286;0.0203822758955488;0.0148414086104833;0.0119796681002687;0.0156614634547265;0.0136130142522304;0.0172281301193336;0.0126421587620668;0.0128448674348101;0.0160283188330622;0.016373437330112;0.011564458804116;0.0141183407591101;0.0155546718330009;0.015739661121539;0.0104544201694077;0.0196306972033275;0.0131505919123791];
y1_step1.xoffset = [-61.1379461132487;0.149512773840829;0.000298979478876859;8.41845333400988e-05;-59.2747476824679;0.0617430866377079;0.000119497567322951;0.000328955845460313;-40.5004103795974;0.00471800338989012;1.67824859577985e-06;1.34657090468804e-06;-50.7251339376021;0.00281279006415684;0.00015759219336968;4.47620877416593e-05;-45.9731592506778;0.0429541976138319;4.77717123201747e-05;0.000243495669545724];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
